<mvc:View controllerName="zsalesorder.controller.SaleOrderList"
    xmlns:t="sap.ui.table"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns:u="sap.ui.unified"
	xmlns:c="sap.ui.core"
    xmlns="sap.m">
    <Page id="page" title="{i18n>title}">
        <content>
            <FlexBox justifyContent="End" >
                <FlexBox>
                    <Select
                        id="templateList"
                        forceSelection="false"
                        items="{
                            path: '/TemplateExport',
                            parameters: {
                                '$select': 'Name,TemplateAlias'
                            },
                            sorter: { path: 'Name' }
                        }">
                        <c:Item key="{TemplateAlias}" text="{Name}" />
                    </Select>
                    <Button
                        text="Export Excel"
                        press="handleExportExcel"/>

                    <Button
                        text="Export Excel By RAP"
                        press="handleExportExcelByRAP"/>
                    <Button
                        text="Export PDF"
                        press="handleExportPDF"/>
                    <Button
                        text="Export PDF with Chart"
                        press="handleExportPDFWithChart"/>
                    <Button
                        text="Export large Excel"
                        press="handleExportLargeData"/>
                </FlexBox >
            </FlexBox>
            
            <Table
                id="SalesOrderList" 
                items="{
                    path: '/ZC_SALESORDER',
                    parameters: {
                        '$select': 'SalesOrder,SoldToParty,CustomerName,SalesOrganization,DistributionChannel'
                    }
                }"
                growing="true"
                growingThreshold="20"
                growingTriggerText="Load thêm"
                growingScrollToLoad="true"
                inset="true"
                mode="SingleSelectLeft"
                headerText="Danh sách Sales Order">
                <columns>
                    <Column>
                        <Text text="SO Number" />
                    </Column>
                    <Column>
                        <Text text="Sold To Party" />
                    </Column>
                    <Column>
                        <Text text="Customer Name" />
                    </Column>
                    <Column>
                        <Text text="Sales Organization" />
                    </Column>
                    <Column>
                        <Text text="Distribution Channel" />
                    </Column>
                </columns>
                <items>
                    <ColumnListItem vAlign="Middle">
                        <cells>
                            <Text text="{SalesOrder}" />
                            <Text text="{SoldToParty}" />
                            <Text text="{CustomerName}" />
                            <Text text="{SalesOrganization}" />
                            <Text text="{DistributionChannel}" />
                        </cells>
                    </ColumnListItem>
                </items>
            </Table>

            <VBox id="customLoading" class="loader"></VBox>
        </content>
    </Page>
</mvc:View>